<div class="modal-backdrop" *ngIf="show" (click)="close.emit()"></div>
<section class="modal" *ngIf="show" role="dialog" aria-modal="true">
  <div class="row-head">
    <h2>Edit User Message</h2>
    <button class="secondary" (click)="close.emit()">Close</button>
  </div>

  <article class="config-block">
    <div class="file-input-row">
      <label class="file-input-btn">
        Add text files
        <input
          type="file"
          accept=".txt,.md,.csv,.json,text/plain,text/markdown,text/csv,application/json"
          multiple
          (change)="onFileChange($event)"
        />
      </label>
      <span class="muted" *ngIf="attachments.length > 0">{{ attachments.length }} file(s)</span>
    </div>
    <div class="attachment-list" *ngIf="attachments.length > 0">
      <span class="attachment-chip" *ngFor="let file of attachments; let i = index">
        {{ file.name }}
        <button type="button" (click)="removeAttachment.emit(i)" aria-label="Remove file">Ã—</button>
      </span>
    </div>
    <label>
      Message
      <textarea rows="6" [ngModel]="content" (ngModelChange)="contentChange.emit($event)"></textarea>
    </label>
    <div class="edit-mode">
      <label class="mode-option">
        <input
          type="radio"
          name="editMode"
          value="inplace"
          [ngModel]="mode"
          (ngModelChange)="modeChange.emit($event)"
        />
        <span>Replace in this chat (delete all following messages)</span>
      </label>
      <label class="mode-option">
        <input
          type="radio"
          name="editMode"
          value="fork"
          [ngModel]="mode"
          (ngModelChange)="modeChange.emit($event)"
        />
        <span>Fork chat here and apply edit in the fork</span>
      </label>
    </div>
  </article>

  <div class="actions">
    <button class="primary" (click)="apply.emit()">Apply</button>
    <button class="secondary" (click)="close.emit()">Cancel</button>
  </div>
</section>
